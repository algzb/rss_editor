[English](#eng) | [Russian](#rus)

# <a name="eng"></a> Simple RSS Editor
## Required GET-parameter
* `url` — RSS feed URL for processing

## Optional GET-parameters: purpose and processing order
|   | Parameter name             | Value type                              | Sense of value element   | What Does It Do                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---|----------------------------|-----------------------------------------|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1 | `amp`                      | presence/absence                        | do/don't do              | It replaces all `&amp;` occurrences with `&` (cases like `&amp;amp;`, `&amp;quot;`, etc.)                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 2 | *[it's always executed]*   | —                                       | —                        | It replaces all HTML entities with appropriate number code in accord with XML standard, e.g. replacing `&quot;` with `&#34;`                                                                                                                                                                                                                                                                                                                                                                                                      |
| 3 | `add_namespace`            | string                                  | namespace                | It adds namespace by means of `add_namespace` value pasting in the attribute list of `rss` tag                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 4 | `remove`                   | string or array of strings              | tag name                 | It removes all listed tags                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 5 |`rename_from` and `rename_to`|strings or same length arrays of strings| tag name before and after| It renames `rename_from` tag to `rename_to`. If parameters are arrays then rename `rename_from[i]` tag to `rename_to[i]` for each `i`                                                                                                                                                                                                                                                                                                                                                                                             |
| 6 | `split`                    | string or array of strings              | tag name                 | It splits tag content into words (assumption: tag content in CamelCase style) and put each word into the new tags with the same name                                                                                                                                                                                                                                                                                                                                                                                              |
| 7 | `break`                    | string or array of strings              | tag name                 | It pastes `<br/>` into the tag content instead of each `\n` and `\r` character (multiple consecutive characters replaced with single `<br/>`)                                                                                                                                                                                                                                                                                                                                                                                     |
| 8 | `cdata`                    | string or array of strings              | tag name                 | It wraps tag content in `<![CDATA[ ... ]]>` block                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 9 |`replace_from`, `replace_to`| string or array of strings              | regular expression       | These and the two following parameters are for a tag content replacement. It replaces each match of `replace_from` (or `replace_from[i]`) regexp in the content of tag `replace_in` (or `replace_in[i]`) in accord with `replace_to` (or `replace_to[i]`) regexp. Regexps are in PCRE notation, but starting and ending `/` character **must be absent**. These parameters can be used for the ordinary replacement, but <code>\ + * ? [ ^ ] $ ( ) { } = ! < > &#124; : -</code> characters must be escaped  by a `\` character (e.g, `\(`). |
| 9 | `replace_in`               | string or array of strings              | tag name                 | Tag which content will be replaced. If its value is `*` then replacement will be in **each** tag of feed (including `<pubDate>`, `<link>`, etc.).                                                                                                                                                                                                                                                                                                                                                                                 |
| 9 | `replace_sens`             | presence/absence                        | match case or not        | Case sensitivity. If `replace_sens` (or `replace_sens[i]`) is passed then replacement will be case sensitive else not.                                                                                                                                                                                                                                                                                                                                                                                                            |
|10 | `add_category`             | string                                  | [XPath 1.0 expression](http://www.w3schools.com/xsl/xpath_intro.asp) | It extracts values from a webpage of each RSS item (webpage URL is extracted from a `<link>` if it exists else item is ignored) using XPath expression and add `<category>` elements (to the appropriate RSS item) for each extracted value. If XPath-expression extracts whole tags then category will contain HTML-code, therefore XPath-expression must extract the final text (array of texts)                                                                                    |

## Example
Replacing `&amp;` with `&` in the tags content,
adding `xmlns:yandex="http://news.yandex.ru/"` namespace,
removing `description` tag,
renaming `full-text` tag (from `yandex` namespace) to `description`,
wrapping content of `title` and `description` tags into `CDATA` block,
adding `<br/>` instead of break lines characters in the `description` tag content,
also replacing all `ё` occurrences with `е` (case insensitive) in the`description` tag content:
in the RSS feed http://milknews.ru/index/novosti-moloko.rss
```
index.php?url=http%3A%2F%2Fmilknews.ru%2Findex%2Fnovosti-moloko.rss&amp&add_namespace=xmlns%3Ayandex%3D%22http%3A%2F%2Fnews.yandex.ru%2F%22&remove=description&rename_from=full-text&rename_to=description&cdata[]=title&cdata[]=description&break=description&replace_from=ё&replace_to=е&replace_in=description
```

# <a name="rus"></a> Простенький редактор RSS-ленты
## Обязательный GET-параметр
* `url` — URL RSS-ленты для обработки

## Необязательные GET-параметры: возможности и порядок их выполнения

|   | Имя параметра              | Тип каждого из параметров               | Семантика элемента типа  | Действие                                                                                                                                                                                                              |
|---|----------------------------|-----------------------------------------|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1 | `amp`                      | наличие/отсутствие                      | делать/не делать         | замена всех вхождений `&amp;` на `&` (для случаев вида `&amp;amp;`, `&amp;quot;` и т.п.)                                                                                                                              |
| 2 | *[автоматически всегда]*   | —                                       | —                        | замена всех HTML-сущностей на их числовой код, чтобы соответствовать XML, например, `&quot;` заменяется на `&#34;`                                                                                                    |
| 3 | `add_namespace`            | строка                                  | пространство имен        | добавление пространства имен путем простой вставки содержимого `add_namespace` в список атрибутов тега `rss`                                                                                                          |
| 4 | `remove`                   | строка или массив строк                 | имя тега                 | удаление всех тегов с перечисленными именами                                                                                                                                                                          |
| 5 | `rename_from` и `rename_to`| строки или одинаковых длин массивы строк| имя тега до и после      | переименование тега с именем `rename_from` в имя `rename_to`, а в случае массивов переименование тега с именем `rename_from[i]` в `rename_to[i]`                                                                      |
| 6 | `split`                    | строка или массив строк                 | имя тега                 | разбиение содержимого тега с заданным именем на отдельные слова (предполагая, что изначальное содержимое оформлено в стиле CamelCase) и помещение их  в нижнем регистре в отдельные теги с тем же изначальным именем  |
| 7 | `break`                    | строка или массив строк                 | имя тега                 | вставка `<br/>` внутри каждого тега с заданным именем заместо переносов строк `\n` и `\r` (если идет несколько переносов подряд, то заменяется лишь на одну вставку `<br/>`)                                          |
| 8 | `cdata`                    | строка или массив строк                 | имя тега                 | заворачивание содержимого тегов с заданным именем в структуру `<![CDATA[ ... ]]>`                                                                                                                                     |
| 9 |`replace_from`, `replace_to`| строка или массив строк                 | регулярное выражение     | эти и два последующих параметра служат для замен в оборачиваемых тегами текстах. В теге с именем `replace_in` всякое соответствие регулярному выражению `replace_from` (в нотации PCRE, **без** окаймляющих символов `/`) заменяется в соответствии с регулярным выражением  `replace_to`.   Параметры могут использоваться для обычной замены, только любой из символов <code>\ + * ? [ ^ ] $ ( ) { } = ! < > &#124; : -</code> должен быть экранирован символов `\` (например, `\(`).|
| 9 | `replace_in`               | строка или массив строк                 | имя тега                 | может принимать специальное значение `*`, что приведёт к поиску и замене соответствий во всех тегах, включая служебные (`<pubDate>`, `<link>` и др.).                                                                 |
| 9 | `replace_sens`             | наличие/отсутствие или массив наличий/отсутствий | учитывать регистр или нет | Если для текущей пары регулярных выражений присутствует `replace_sens`, то поиск ведётся с учётом регистра, иначе без учёта.                                                                                |
|10 | `add_category`             | строка                                  | [XPath-выражение 1.0](http://www.w3schools.com/xsl/xpath_intro.asp) | добавление каждому RSS-элементу категорий `<category>`, содержимое которых определяется XPath-выражением (XPath 1.0), извлекающее список чего-либо со страницы этого RSS-элемента (адрес берётся из тега `link`, если он есть), впоследствии преобразуемое в список строк. Если XPath-выражение извлекает целые теги, то в итоге категорией будет HTML-код, поэтому XPath-выражение должно извлекать сразу нужную информацию — значение содержимого или атрибута тега |

Пример работы параметра `split`: подано значение `split=tag`, поэтому было `<tag>КрепостьЧПЗдоровьеНебо</tag>`, стало `<tag>крепость</tag><tag>чп</tag><tag>здоровье</tag><tag>небо</tag>`

## Пример использования
В RSS-ленте http://milknews.ru/index/novosti-moloko.rss замена `&amp;` на `&`, добавление пространства имен `xmlns:yandex="http://news.yandex.ru/"`, удаление тега `description`, переименования тега `full-text` (из пространства `yandex`) в `description`, заворачивание в `CDATA` содержимое тегов `title` и `description`, а также добавление `<br/>` заместо переносов строк в содержимом тега `description`, дополнительно к этому проводится замена всех вхождений буквы `ё` на `е` (без учёта регистра) в тегах с именем `description`:
```
index.php?url=http%3A%2F%2Fmilknews.ru%2Findex%2Fnovosti-moloko.rss&amp&add_namespace=xmlns%3Ayandex%3D%22http%3A%2F%2Fnews.yandex.ru%2F%22&remove=description&rename_from=full-text&rename_to=description&cdata[]=title&cdata[]=description&break=description&replace_from=ё&replace_to=е&replace_in=description
```
